"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeRequest = exports.makeParameterLessRequest = exports.makeAuthenticatedRequest = void 0;
const types_1 = require("../types");
const makeRequestInternal = async (query, resultKey, axiosInstance, variables, config) => {
    var _a;
    const { data } = await axiosInstance.post(`/${encodeURIComponent(resultKey)}`, {
        query,
        variables,
    }, config);
    const result = (_a = data === null || data === void 0 ? void 0 : data.data) === null || _a === void 0 ? void 0 : _a[resultKey];
    const errors = data === null || data === void 0 ? void 0 : data.errors;
    if (result != null) {
        return result;
    }
    if (errors != null) {
        throw new types_1.GqlError(resultKey, errors);
    }
    throw new Error('Unknown error in makeRequest');
};
const makeAuthenticatedRequest = (query, resultKey) => {
    return (axiosInstance, jwt, variables) => makeRequestInternal(query, resultKey, axiosInstance, variables, {
        headers: { Authorization: `Bearer ${jwt}` },
    });
};
exports.makeAuthenticatedRequest = makeAuthenticatedRequest;
const makeRequest = (query, resultKey) => {
    return (axiosInstance, variables) => makeRequestInternal(query, resultKey, axiosInstance, variables);
};
exports.makeRequest = makeRequest;
const makeParameterLessRequest = (query, resultKey) => {
    return (axiosInstance) => makeRequestInternal(query, resultKey, axiosInstance, undefined);
};
exports.makeParameterLessRequest = makeParameterLessRequest;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXhpb3NSZXF1ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL3V0aWxzL2F4aW9zUmVxdWVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxvQ0FBb0M7QUFRcEMsTUFBTSxtQkFBbUIsR0FBRyxLQUFLLEVBQy9CLEtBQWEsRUFDYixTQUFpQixFQUNqQixhQUF3QixFQUN4QixTQUFnQixFQUNoQixNQUFrQyxFQUNqQixFQUFFOztJQUNuQixNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsTUFBTSxhQUFhLENBQUMsSUFBSSxDQUN2QyxJQUFJLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQ25DO1FBQ0UsS0FBSztRQUNMLFNBQVM7S0FDVixFQUNELE1BQU0sQ0FDUCxDQUFDO0lBRUYsTUFBTSxNQUFNLEdBQUcsTUFBQSxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsSUFBSSwwQ0FBRyxTQUFTLENBQUMsQ0FBQztJQUN2QyxNQUFNLE1BQU0sR0FBRyxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsTUFBTSxDQUFDO0lBQzVCLElBQUksTUFBTSxJQUFJLElBQUksRUFBRTtRQUNsQixPQUFPLE1BQU0sQ0FBQztLQUNmO0lBRUQsSUFBSSxNQUFNLElBQUksSUFBSSxFQUFFO1FBQ2xCLE1BQU0sSUFBSSxnQkFBUSxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQztLQUN2QztJQUVELE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQThCLENBQUMsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFRixNQUFNLHdCQUF3QixHQUFHLENBQy9CLEtBQWEsRUFDYixTQUFpQixFQUtHLEVBQUU7SUFDdEIsT0FBTyxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLEVBQUUsQ0FDdkMsbUJBQW1CLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsU0FBUyxFQUFFO1FBQzlELE9BQU8sRUFBRSxFQUFFLGFBQWEsRUFBRSxVQUFVLEdBQUcsRUFBRSxFQUFFO0tBQzVDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQztBQWtCTyw0REFBd0I7QUFoQmpDLE1BQU0sV0FBVyxHQUFHLENBQ2xCLEtBQWEsRUFDYixTQUFpQixFQUNrRCxFQUFFO0lBQ3JFLE9BQU8sQ0FBQyxhQUFhLEVBQUUsU0FBUyxFQUFFLEVBQUUsQ0FDbEMsbUJBQW1CLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDcEUsQ0FBQyxDQUFDO0FBVTJELGtDQUFXO0FBUnhFLE1BQU0sd0JBQXdCLEdBQUcsQ0FDL0IsS0FBYSxFQUNiLFNBQWlCLEVBQ2dDLEVBQUU7SUFDbkQsT0FBTyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQ3ZCLG1CQUFtQixDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUUsYUFBYSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQ3BFLENBQUMsQ0FBQztBQUVpQyw0REFBd0IifQ==